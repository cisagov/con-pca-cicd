<div class="p-3">
    <h1>Add Continuous Phishing Organization</h1>
    <div class="d-flex flex-row mb-3">
        <div class="d-flex flex-grow-1 flex-column">
            <div class="d-flex flex-row mb-3">
                <button mat-raised-button color="primary" (click)="createNew()">Create New</button>
                <button mat-raised-button color="accent">Edit</button>
                <button mat-raised-button color="warn">Delete</button>
            </div>
            <div class="d-flex flex-row" [formGroup]="organizationFormGroup">
                <mat-form-field appearance="outline" class="flex-grow-1">
                    <mat-label>Organization Id</mat-label>
                    <input type="text" matInput disabled placeholder="Organization Id" [formControl]="organizationFormGroup.controls.organizationId">
                </mat-form-field>
            </div>
            <div class="d-flex flex-row">
                <mat-form-field appearance="outline" class="flex-grow-1" [formGroup]="organizationFormGroup">
                    <mat-label>Organization Name*</mat-label>
                    <input type="text" matInput placeholder="Organization Name" formControlName="organizationName"
                    [errorStateMatcher]="matchOrganizationName">
                    <mat-error *ngIf="organizationFormGroup.controls.organizationName.hasError('required')">
                    Organization name is <strong>required</strong>
                    </mat-error>
                </mat-form-field>
            </div>
                <div class="d-flex flex-row" >
                <mat-form-field appearance="outline" class="flex-grow-1" [formGroup]="organizationFormGroup">
                    <mat-label>Organization Identifier*</mat-label>
                    <input type="text" matInput placeholder="Organization Identifier" formControlName="organizationIdentifier"
                    [errorStateMatcher]="matchOrganizationIdentifier">
                    <mat-error *ngIf="organizationFormGroup.controls.organizationIdentifier.hasError('required')">
                    Organization identifier is <strong>required</strong>
                    </mat-error>
                </mat-form-field>
            </div>
            <!-- Place holder for Government Type -->
            <div class="d-flex flex-row" >
                <mat-form-field appearance="outline" class="flex-grow-1" [formGroup]="organizationFormGroup">
                    <mat-label>Address 1*</mat-label>
                    <input type="text" matInput placeholder="Address 1" formControlName="address1"
                    [errorStateMatcher]="matchAddress1">
                    <mat-error *ngIf="organizationFormGroup.controls.address1.hasError('required')">
                        Address 1 is <strong>required</strong>
                    </mat-error>
                </mat-form-field>
            </div>
            <div class="d-flex flex-row">
                <mat-form-field appearance="outline" class="flex-grow-1" [formGroup]="organizationFormGroup">
                    <mat-label>Address 2</mat-label>
                    <input type="text" matInput placeholder="Address 2" formControlName="address2">
                </mat-form-field>
            </div>
            <div class="d-flex flex-row">
                <mat-form-field appearance="outline" class="flex-grow-1" [formGroup]="organizationFormGroup">
                    <mat-label>City*</mat-label>
                    <input type="text" matInput placeholder="city" formControlName="city"
                    [errorStateMatcher]="matchCity">
                    <mat-error *ngIf="organizationFormGroup.controls.city.hasError('required')">
                        City is <strong>required</strong>
                    </mat-error>
                </mat-form-field>
            </div>
            <div class="d-flex flex-row">
                <mat-form-field appearance="outline" class="flex-grow-1" [formGroup]="organizationFormGroup">
                    <mat-label>State*</mat-label>
                    <input type="text" matInput placeholder="State" formControlName="state"
                    [errorStateMatcher]="matchState">
                    <mat-error *ngIf="organizationFormGroup.controls.state.hasError('required')">
                        State is <strong>required</strong>
                    </mat-error>
                </mat-form-field>
            </div>
            <div class="d-flex flex-row">
                <mat-form-field appearance="outline" class="flex-grow-1" [formGroup]="organizationFormGroup">
                    <mat-label>Zip*</mat-label>
                    <input type="text" matInput placeholder="Zip" formControlName="zip"
                    [errorStateMatcher]="matchZip">
                    <mat-error *ngIf="organizationFormGroup.controls.zip.hasError('required')">
                        Zip is <strong>required</strong>
                    </mat-error>
                </mat-form-field>
            </div>
        </div>
    </div>
    <h1>Organization Contacts</h1>
    <div class="d-flex flex-row mb-5">
        <div class="d-flex flex-grow-1 flex-column">
            <div class="d-flex flex-row">
                <button mat-raised-button color="primary" (click)="showAddContact()" *ngIf="!addContact">Add Contact</button>
            </div>
            
            <div class="d-flex flex-row p-2 flex-grow-1" *ngIf="addContact">
                <mat-card style="width:100%">
                    <mat-card-header>
                        <mat-card-title>Add Contact</mat-card-title>
                    </mat-card-header>
                    <mat-card-content>
                        <div class="d-flex flex-row" >
                            <div class="d-flex flex-column mr-2" [formGroup]="contactFormGroup">
                                <mat-form-field appearance="outline">
                                    <mat-label>First Name*</mat-label>
                                    <input type="text" matInput placeholder="First Name" formControlName="firstName"
                                    [errorStateMatcher]="matchFirstName">
                                    <mat-error *ngIf="contactFormGroup.controls.firstName.hasError('required')">
                                        First name <strong>required</strong>
                                    </mat-error>
                                </mat-form-field>
                            </div>
                            <div class="d-flex flex-column mr-2" [formGroup]="contactFormGroup">
                                <mat-form-field appearance="outline">
                                    <mat-label>Last Name*</mat-label>
                                    <input type="text" matInput placeholder="Last Name" formControlName="lastName"
                                    [errorStateMatcher]="matchLastName">
                                    <mat-error *ngIf="contactFormGroup.controls.lastName.hasError('required')">
                                        Last name <strong>required</strong>
                                    </mat-error>
                                </mat-form-field>
                            </div>
                            <div class="d-flex flex-column" [formGroup]="contactFormGroup">
                                <mat-form-field appearance="outline">
                                    <mat-label>Title</mat-label>
                                    <input type="text" matInput placeholder="Title" formControlName="title">
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="d-flex flex-row">
                            <div class="d-flex flex-column mr-2" [formGroup]="contactFormGroup">
                                <mat-form-field appearance="outline">
                                    <mat-label>Email*</mat-label>
                                    <input type="text" matInput placeholder="Email" formControlName="email"
                                    [errorStateMatcher]="matchEmail">
                                    <mat-error *ngIf="contactFormGroup.controls.email.hasError('required')">
                                        Email <strong>required</strong>
                                    </mat-error>
                                    <mat-error *ngIf="contactFormGroup.controls.email.hasError('email')">
                                        Check email format
                                    </mat-error>
                                </mat-form-field>
                            </div>
                            <div class="d-flex flex-column mr-2" [formGroup]="contactFormGroup">
                                <mat-form-field appearance="outline">
                                    <mat-label>Phone</mat-label>
                                    <input type="text" matInput placeholder="Phone" formControlName="phone">
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="d-flex flex-row flex-grow-1" [formGroup]="contactFormGroup">
                            <mat-form-field appearance="outline" class="flex-grow-1">
                                <mat-label>Contact Notes</mat-label>
                                <textarea matInput formControlName="contactNotes"></textarea>
                            </mat-form-field>
                        </div>
                        <div class="d-flex flex-row flex-grow-1">
                            <div class="alert alert-danger flex-grow-1" *ngIf="contactError">
                                {{contactError}}
                            </div>
                        </div>
                        <button mat-raised-button color="primary" (click)="pushContact()" [disabled]="!contactFormGroup.valid">Add</button>
                        <button mat-flat-button (click)="showAddContact()">Close</button>
                    </mat-card-content>
                </mat-card>
            </div>
            <div class="d-flex flex-row flex-grow-1 mt-3 mb-3">
                <table mat-table [dataSource]="contacts" class="mat-elevation-z1 flex-grow-1" *ngIf="checkDataSourceLength()">                  
                    <!-- Name Column -->
                    <ng-container matColumnDef="name">
                      <th mat-header-cell *matHeaderCellDef> Name </th>
                      <td mat-cell *matCellDef="let element"> {{element.firstName + element.lastName}} </td>
                    </ng-container>
                  
                    <!-- Title Column -->
                    <ng-container matColumnDef="title">
                      <th mat-header-cell *matHeaderCellDef> Title </th>
                      <td mat-cell *matCellDef="let element"> {{element.title}} </td>
                    </ng-container>
                  
                    <!-- Email Column -->
                    <ng-container matColumnDef="email">
                      <th mat-header-cell *matHeaderCellDef> Email </th>
                      <td mat-cell *matCellDef="let element"> {{element.email}} </td>
                    </ng-container>
                  
                    <!-- Phone Column -->
                    <ng-container matColumnDef="phone">
                      <th mat-header-cell *matHeaderCellDef> Phone </th>
                      <td mat-cell *matCellDef="let element"> {{element.phone}} </td>
                    </ng-container>
                  
                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                  </table>
                  <div class="alert alert-danger flex-grow-1" role="alert" *ngIf="!checkDataSourceLength()">
                    No contacts Available
                  </div>
            </div>
            <div class="d-flex flex-row flex-grow-1">
                <div class="alert alert-danger flex-grow-1" *ngIf="orgError">
                    {{orgError}}
                </div>
            </div>
            <div class="d-flex flex-row flex-grow-1 justify-content-end">
                <button mat-raised-button color="primary" [disabled]="!organizationFormGroup.valid" (click)="pushOrganization()">Save Organization</button>
                <button mat-flat-button>Cancel</button>
            </div>
        </div>
    </div>
</div>

